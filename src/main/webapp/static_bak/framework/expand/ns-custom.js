var directives=angular.module("directives",[]);putObject=function(b,a,c){};getObject=function(b,a){};var filters=angular.module("filters",[]);var services=angular.module("services",[]);var custom=custom||{};directives.directive("csDatepicker",["$parse","$timeout",function(b,a){return{restrict:"A",scope:{maxValue:"=maxvalue",minValue:"=minvalue",onChange:"&onChange"},link:function(m,e,l){var h=m.onChange,g=m.maxValue,k=m.minValue,f=l.clickId,i=b(l.ngModel),d=i.assign;var j=function(n){d(m.$parent,n.cal.getDateStr());if(h){h()}a(function(){m.$apply(function(){})})};var c={onpicked:j,dateFmt:"yyyy-MM-dd",readOnly:true,doubleCalendar:true,autoUpdateOnChanged:true,oncleared:j};if(g){c.maxDate=g}if(k){c.minDate=k}e.on("focus",function(){if(m.maxValue){c.maxDate=m.maxValue}if(m.minValue){c.minDate=m.minValue}WdatePicker(c)});if(f){$("#"+f).on("click",function(){if(m.maxValue){c.maxDate=m.maxValue}if(m.minValue){c.minDate=m.minValue}e.focus()})}}}}]);directives.directive("csWindow",["$timeout",function(c){var a=$("body");var b=$('<div class="cs-window-background"></div>');b.hide();a.append(b);var e=function(f,o){var k=$(window),n=f.width(),j=f.height(),l=k.outerWidth(true),i=k.outerHeight(true),m=(i-j)/2-40,g=(l-n)/2;if(o=="true"){f.css("left",g+"px");f.css("top",m+"px")}};var d=function(f,g){f.offset(g)};return{restrict:"A",scope:{show:"=show",offset:"=offset",clickDisappear:"=clickDisappear"},link:function(l,k,i){var h=i.autoCenter||"true",g=i.mask||"true",f=i.clickDisappear||"true";var j=false;l.$watch("show",function(m,n){if(m==true){k.show();if(g==="true"){b.show()}if(l.clickDisappear){c(function(){$(document).one("click",function(o){l.show=false;c(function(){l.$apply()})})})}}else{$(document).unbind("click");k.hide();b.hide()}});if(l.clickDisappear){if(!j){k.on("click",function(m){m.stopPropagation()});j=true}}l.$watch("offset",function(m,n){d(k,m)});if(l.show){k.show()}else{k.hide()}k.addClass("cs-window-windows");if(!l.offset){e(k,h)}else{d(k,l.offset)}}}}]);directives.directive("autoFocus",["$parse","$timeout",function(b,a){return{restrict:"A",link:function(g,e,d){var f=d.autoFocus,c=b(f),h=c(g);if(h){e[0].focus()}if(f!="true"&&f!="false"){g.$watch(f,function(i){if(i==true){e[0].focus()}});e.on("blur",function(){a(function(){g.$apply(c.assign(g,false))})})}}}}]);directives.directive("csSmartinput",["$parse","$timeout","http",function(c,b,i){var j='<div  class="smart-input-block-position" ng-keyup="moveTo($event)"> <div class="smart-input-block" ng-show="listShow">  <ul>      <li  ng-repeat="item in list"  ng-click="selectOption(item,$index)" ng-transclude="child">      </li>  </ul></div>      <input class="smart-input" ng-click="stopPropagation($event)"  ng-focus="focus()" ng-model="queryParam"  ng-change="doAjax(queryParam)" type="text" placeholder="{{placeholder}}" /></div>';var m=function(n,o){i.callService(n).success(function(p){o(p)})};var l="smart-input-block-li";var g,d=-1,a=0,k=true;var e=function(o,n){if(o<=0){return n-1}else{return o-1<0?n-1:o-1}};var h=function(o,n){if(o<0||o==n-1){return 0}else{return o+1==n?0:o+1}};var f=function(r,o,q,p){var n;return function(){var t=p||Array.prototype.slice.call(arguments,0),s=q||this;if(n){clearTimeout(n)}n=setTimeout(function(){r.apply(s,t)},o)}};return{restrict:"A",scope:{onSelected:"&onSelected"},transclude:true,template:j,link:function(y,q,x){var v=x.label,w=x.placeholder,s=x.service,p=x.params,z=x.valueField,t=x.displayField,o=c(x.ngModel).assign,r=x.defaultQuery;y.label=v;y.placeholder=w;var u=q.find("input").first();var n=function(){if(!y.listShow){y.listShow=true;b(function(){y.$apply()});return false}else{return true}};y.selectOption=function(B,A){y.listShow=false;y.$parent.$item=B;o(y.$parent,B[z]);u.val(B[t]);if(y.onSelected){y.onSelected()}delete y.$parent.$item;y.unselectLi(g);g=A;y.selectLi(g)};y.doAjax=f(function(A){var C=[A||null],B={service:s,params:C};g=undefined;d=-1;y.list=[];n();o(y.$parent,undefined);m(B,function(D){y.list=D;a=D.length})},400);y.focus=function(){if(k){k=false}else{y.listShow=true}y.unselectLi(d);y.selectLi(g);if(g!=undefined){d=g}$(document).one("click",function(){y.listShow=false;b(function(){y.$apply()})})};y.stopPropagation=function(A){A.stopPropagation()};y.moveTo=function(B){var A=B.keyCode;if(A==38){if(!n()){return}y.unselectLi(d);d=e(d,a);y.selectLi(d);y.selectLi(g)}else{if(A==40){if(!n()){return}y.unselectLi(d);d=h(d,a);y.selectLi(d);y.selectLi(g)}else{if(A==13){if(d>=0){y.selectOption(y.list[d],d)}}}}};y.selectLi=function(A){if(a!=undefined&&a>0){if(A!=undefined&&A>=0&&A<=a-1){q.find("li").eq(A).addClass(l)}}};y.unselectLi=function(A){if(a!=undefined&&a>0){if(A!=undefined&&A>=0&&A<=a-1){q.find("li").eq(A).removeClass(l)}}}}}}]);directives.directive("csSelect",["$parse","$timeout","http",function(f,d,c){var b='<div  class="smart-input-block-position" ng-keyup="moveTo($event)"> <div class="smart-input-block" ng-show="listShow">  <ul>      <li  ng-repeat="item in list"  ng-click="selectOption(item,$index)" ng-transclude="child">      </li>  </ul></div>      <input class="smart-input cs-select-select" ng-model="display" ng-readonly="true" ng-click="stopPropagation($event)"  ng-focus="focus()" type="text" placeholder="{{placeholder}}" /></div>';var e=function(i,j){c.callService(i).success(function(k){j(k)})};var g="smart-input-block-li";var a=function(j,i){if(j<=0){return i-1}else{return j-1<0?i-1:j-1}};var h=function(j,i){if(j<0||j==i-1){return 0}else{return j+1==i?0:j+1}};return{restrict:"A",scope:{onSelected:"&onSelected",list:"=data",value:"=ngModel",disabled:"=disabled"},transclude:true,template:b,link:function(j,l,t){var n=t.placeholder,z=t.service,i=t.valueField,v=t.displayField,o=f(t.ngModel),x=o.assign;var r,u=-1,m=0,w=true,s=false;j.placeholder=n;var q=l.find("input").first();var p=function(){if(!j.listShow){j.listShow=true;d(function(){j.$apply()});return false}else{return true}};var y=function(){if(z){var A={service:z,params:[]};e(A,function(D){var C=o(j.$parent);j.list=D;m=D.length;k(C,D,j)})}else{if(t.data){var B=o(j.$parent);if(j.list){m=j.list.length;k(B,j.list,j)}}}j.$watch("value",function(C){if(s==true){s=false;return}if(j.list){k(C,j.list,j)}});j.$watch("list",function(){if(j.list){m=j.list.length;k(j.value,j.list,j)}})};var k=function(F,E,C){if(!F){C.display=null}for(var B=0,A=E.length;B<A;B++){var D=E[B];if(D[i]==F){s=true;C.listShow=false;C.value=D[i];C.display=D[v];C.unselectLi(r);r=B;C.selectLi(r);return}}};j.selectOption=function(B,A){s=true;j.listShow=false;j.$parent.$item=B;j.value=B[i];j.display=B[v];if(j.onSelected){j.onSelected()}delete j.$parent.$item;j.unselectLi(r);r=A;j.selectLi(r)};j.focus=function(){if(j.disabled){return}j.listShow=true;j.unselectLi(u);j.selectLi(r);if(r!=undefined){u=r}$(document).one("click",function(){j.listShow=false;d(function(){j.$apply()})})};j.stopPropagation=function(A){A.stopPropagation()};j.moveTo=function(B){var A=B.keyCode;if(A==38){if(!p()){return}j.unselectLi(u);u=a(u,m);j.selectLi(u);j.selectLi(r)}else{if(A==40){if(!p()){return}j.unselectLi(u);u=h(u,m);j.selectLi(u);j.selectLi(r)}else{if(A==13){if(u>=0){j.selectOption(j.list[u],u)}}}}};j.selectLi=function(A){if(m!=undefined&&m>0){if(A!=undefined&&A>=0&&A<=m-1){l.find("li").eq(A).addClass(g)}}};j.unselectLi=function(A){if(m!=undefined&&m>0){if(A!=undefined&&A>=0&&A<=m-1){l.find("li").eq(A).removeClass(g)}}};y()}}}]);directives.directive("csEditor",["$parse",function(b){function a(d,e){var c=document.createElement("script");c.src=d;c.anysc=true;if(c.onload==null){c.onload=function(){typeof e=="function"&&e()}}else{c.onreadystatechange=function(){if(c.readyState=="loaded"||c.readyState=="complete"){typeof e=="function"&&e()}}}document.getElementsByTagName("body")[0].appendChild(c)}return{restrict:"A",require:"ngModel",scope:{height:"@?",width:"@?"},link:function(k,f,j,c){var i=this,h,g,l=false,d=httpConfig.basePath+"/framework/components/ueditor/";var e={initEditor:function(){var m=this;if(typeof UE!="undefined"){g=new UE.ui.Editor({initialContent:h,toolbars:[["customstyle","paragraph","fontfamily","fontsize","|","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","horizontal","date","time","spechars","snapscreen","wordimage","|","fullscreen"],["removeformat","formatmatch","autotypeset","bold","italic","underline","fontborder","strikethrough","superscript","subscript","forecolor","backcolor","rowspacingtop","rowspacingbottom","lineheight","|","insertorderedlist","insertunorderedlist","|","blockquote","pasteplain","selectall","cleardoc","|"],["inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","charts","|","link","unlink","anchor","|","simpleupload","insertimage","imagenone","imageleft","imageright","imagecenter","|","emotion","music","attachment","map","template","background","|",],["source","|","print","preview","searchreplace","|","undo","redo","help"]],initialFrameHeight:k.height||120,autoHeightEnabled:false,wordCount:false,elementPathEnabled:false});g.render(f[0]);g.ready(function(){l=true;m.setContent(h);g.addListener("contentChange",function(){k.$apply(function(){c.$setViewValue(g.getContent())})})})}else{a(d+"ueditor.config.js");a(d+"ueditor.all.min.js",function(){m.initEditor()})}},setContent:function(m){if(g&&l){g.setContent(m)}}};c.$render=function(){h=c.$isEmpty(c.$viewValue)?"":c.$viewValue;e.setContent(h)};e.initEditor()}}}]);directives.directive("csMask",["$parse",function(d){var b="cs-window-background",e=2999,a=$("body"),c=function(){var f=$('<div class="cs-mask-background"><div class="cs-mask-loading"><div class="cs-mask-img"></div><div></div>');f.hide();a.append(f);return f};return{restrict:"A",scope:{csMask:"="},link:function(k,j,h){var g=c();var f=function(){g.height(j.outerHeight());g.width(j.outerWidth());g.offset(j.offset());g.show()};var i=function(){g.offset({top:0,left:0});g.hide()};if(k.csMask){f()}k.$watch("csMask",function(m,l){if(m==true){f()}else{i()}})}}}]);directives.directive("valueFillService",["http","$compile",function(b,d){function e(g,h){if(angular.isArray(h)){a(g,h)}else{if(!angular.isArray(h)&&angular.isObject(h)){f(g,h)}else{c(g,h)}}}function a(j,k){j.list=k;for(var h=0,g=k.length;h<g;h++){j[h]=k[h]}}function f(h,j){h.map=j;for(var g in j){h[g]=j[g]}}function c(h,g){h["0"]=g}return{restrict:"A",scope:{service:"@",params:"=",cls:"@class",style:"@style"},transclude:true,replace:true,template:"<span ng-transclude='child' class={{cls}} style='{{style}}'></span>",link:function(h,j,i){var g=h.service,l=h.params,k={service:g,params:l};b.callService(k).success(function(m){e(h,m);scope.$apply(function(){})})}}}]);angular.module("services").factory("model",function(){return{getObject:function(d,f){if(!f){return undefined}var c=f.split(".");var e=d;for(var b=0;b<c.length;b++){var a=c[b];if(b==c.length-1){return e[a]}else{if(!e[a]){return null}}e=e[a]}return e},putObject:function(d,g,e){var c=g.split(".");var f=d;for(var b=0;b<c.length;b++){var a=c[b];if(b==c.length-1){f[a]=e}else{if(!f[a]){f[a]={}}}f=f[a]}np=e}}});angular.module("services").factory("dialog",["$compile","$rootScope",function(f,j){var g=$("body");var l=$('<div class="cs-window-background"></div>');l.hide();g.append(l);var c=function(q){var m=$(window),n=q.width(),p=q.height(),t=m.innerWidth(),o=m.innerHeight(),s=(o-p)/2-40,r=(t-n)/2;q.css("left",r+"px");q.css("top",s+"px")};var a='<div class="dialog-windows-pt-body"><div class="dialog-windows-pt-close dialog-windows-pt-close-red" ng-click="$dialog_error_close()"></div><div class="dialog-windows-pt-img dialog-windows-pt-img-red">{replacement}</div><div class="dialog-windows-pt-button dialog-windows-pt-button-red" ng-click="$dialog_error_close()">关闭</div></div>';var h='<div class="dialog-windows-pt-body"><div class="dialog-windows-pt-close dialog-windows-pt-close-orange" ng-click="$dialog_warn_close()"></div><div class="dialog-windows-pt-img dialog-windows-pt-img-orange">{replacement}</div><div class="dialog-windows-pt-button dialog-windows-pt-button-orange" ng-click="$dialog_warn_close()">关闭</div></div>';var d='<div class="dialog-windows-pt-body"><div class="dialog-windows-pt-close dialog-windows-pt-close-green" ng-click="$dialog_info_close()"></div><div class="dialog-windows-pt-img dialog-windows-pt-img-green">{replacement}</div><div class="dialog-windows-pt-button dialog-windows-pt-button-green" ng-click="$dialog_info_close()">好的</div></div>';var b='<div class="dialog-windows-pt-body"><div class="dialog-windows-pt-close dialog-windows-pt-close-blue"  ng-click="$dialog_confirm_close()"></div><div class="dialog-windows-pt-img dialog-windows-pt-img-blue">{replacement}</div><div class="dialog-windows-pt-button"> <span class=" dialog-windows-pt-button-blue dialog-windows-pt-span"  ng-click="$dialog_confirm_sure()">确认</span><span class=" dialog-windows-pt-button-blue dialog-windows-pt-span dialog-windows-pt-list"  ng-click="$dialog_confirm_cancel()">取消</span> </div></div>';var k='<div class="dialog-windows-pt-body"><div class="dialog-windows-pt-close dialog-windows-pt-close-qing" ng-click="$dialog_success_close()"></div><div class="dialog-windows-pt-img dialog-windows-pt-img-qing">{replacement}</div><div class="dialog-windows-pt-button dialog-windows-pt-button-qing" ng-click="$dialog_success_close()">关闭</div></div>';var e=function(m,o){var n=$(f(m.replace("{replacement}",o))(j));g.append(n);l.show();n.show();c(n);return n};var i={};return{error:function(m){j.$dialog_error_close=function(){i.error.remove();l.hide();delete i.error};i.error=i.error||e(a,m)},warn:function(m){j.$dialog_warn_close=function(){i.warn.remove();l.hide();delete i.warn};i.warn=i.warn||e(h,m)},info:function(m){j.$dialog_info_close=function(){i.info.remove();l.hide();delete i.info};i.info=i.info||e(d,m)},success:function(m){j.$dialog_success_close=function(){i.success.remove();l.hide();delete i.success};i.success=i.success||e(k,m)},confirm:function(n,o,m){j.$dialog_confirm_close=function(){i.confirm.remove();l.hide();delete i.confirm};j.$dialog_confirm_sure=function(){i.confirm.remove();l.hide();delete i.confirm;if(o){o()}};j.$dialog_confirm_cancel=function(){i.confirm.remove();l.hide();delete i.confirm;if(m){m()}};i.confirm=i.confirm||e(b,n)}}}]);angular.module("services").factory("extTemplate",["$http",function(a){return{getHtml:function(d,c){var b=new NS.Template(d);return b.apply(c)},getHtmlByTemplateUrl:function(c,d){var e=this,f,b={success:function(g){f=g}};a({method:"GET",url:c}).success(function(h){var g=e.getHtml(h,d);if(f){f(g)}});return b}}}]);angular.module("services").factory("mask",function(){var a=$("body");var b=$('<div class="cs-window-background"></div>');var c=$('<div class="cs-window-loading"><div class="cs-window-img"></div></div>');b.hide();c.hide();a.append(b);a.append(c);return{show:function(){b.show()},hide:function(){b.hide()},showLoading:function(){b.show();c.show()},hideLoading:function(){b.hide();c.hide()}}});angular.module("services").factory("http",["$http",function(b){var a=httpConfig.baseUrl;return{callService:function(f){var e=angular.copy(f),g=e.params,d="data",j=[],i=e.service.split("?"),h,c={success:function(k){h=k}};delete e.service;e.server=i[0];e.method=i[1];if(!e.params){e.params=[]}e.params=angular.toJson(e.params);b({method:"POST",url:a,data:e}).success(function(k){if(h){h(k.result)}else{c[d]=k.result;delete c.success}});return c},call:function(f){var e=this,h=[f],d=[],g,c={call:function(i){h.push(i);return this},end:function(k){g=k;var j=0;var i=function(l){if(angular.isFunction(l)){l=l.apply(window,d)}e.callService(l).success(function(n){d.push(n);if(j<h.length-1){var m=h[j+1];i(m)}else{if(j==h.length-1){g.apply(window,d)}}j++})};i(h[j])}};return c}}}]);angular.module("services").factory("fileUpload",["$upload",function(b){var a=httpConfig.uploadUrl;return{upload:function(e){var f,d=e.files,c={success:function(g){f=g}};delete e.files;if(d&&d.length){b.upload({url:a,file:d,data:e}).progress(function(g){var h=parseInt(100*g.loaded/g.total);console.log("progress: "+h+"% "+g.config.file.name)}).success(function(i,g,j,h){if(f){f(i)}})}return c}}}]);(function(){var b=httpConfig.basePath;var a=navigator.userAgent.toLowerCase();$.browser=$.browser||{version:(a.match(/.+( :rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(a),Opera:/opera/.test(a),msie:/msie/.test(a)&&!/opera/.test(a),mozilla:/mozilla/.test(a)&&!/(compatible|webkit)/.test(a)};if(!$.browser.msie){FileAPI={}}else{FileAPI={jsUrl:b+"/framework/angular/fileupload/FileAPI.min.js",flashUrl:b+"/framework/angular/fileupload/FileAPI.flash.swf"}}})();angular.module("services").factory("fileDownload",function(){var b=httpConfig.downloadUrl;var a=$("<iframe style='display:none;' id='system_for_download'></iframe>");$("body").append(a);a.attr("src","..");return{download:function(d){var f=b+"?",c=d.service,e=d.params||{};smarray=c.split("?");f+="service="+smarray[0];f+="&method="+smarray[1];f+="&params="+angular.toJson(e);a.attr("src",f)}}});angular.module("services").factory("response",function(){var a=$("body"),b=function(e,c){var d="";if(e instanceof String||e instanceof Number||e instanceof Boolean){d+="&"+c+"="+encodeURIComponent(e)}else{$.each(e,function(g){var f=c==null?g:c+(e instanceof Array?"["+g+"]":"."+g);d+="&"+b(this,f)})}return d.substr(1)};return{redirect:function(c,d){window.location.href=httpConfig.basePath+"/"+c+"?"+b(d||{})},redirect_new:function(c,e){var d=httpConfig.basePath+"/"+c+"?"+b(e||{});var f=window.open("_blank");f.location=d}}});angular.module("services").factory("user",["userObj","http",function(a,b){var a;$.ajax({async:false,url:httpConfig.baseUrl,data:{server:"loginService",method:"getUser",params:"[]"},dataType:"json",type:"POST",success:function(c){a=c.result}});return{getUsername:function(){return a.username},getLastLoginTime:function(){return a.logintime||""},getLastLoginIp:function(){return"192.168.100.5"},getDepartmentName:function(){return a.bmmc},getRyId:function(){return a.ryId}}}]);custom.controller=(function(){function c(d){return d[d.length-1]}function a(d){d.splice(d.length-1,1);return d}function b(f){for(var e=0,d=f.length;e<d;e++){if(angular.isString(f[e])&&f[e]=="$scope"){return e}}return -1}return function(i,f,k){if(!angular.isArray(k)){throw new Error("controller传入的第三个参数必须是一个数组!")}var e=angular.module(i);var d=b(k);var g=c(k);var j=a(k);var h=function(){var l=arguments[d];g.apply(this,arguments)};j.push(h);e.controller(f,j)}})();custom.service=(function(){function b(c){return c[c.length-1]}function a(c){c.splice(c.length-1,1);return c}return function(g,c,i){var d=angular.module(g);if(angular.isArray(i)){var e=b(i);var h=a(i);var f=function(){return e.apply(this,arguments)};h.push(f);d.factory(c,h)}else{if(angular.isFunction(i)){var f=function(){return i.apply(this,arguments)};d.factory(c,f)}}}})();angular.module("directives").config(function(a){a.decorator("ngTranscludeDirective",["$delegate",function(b){b.shift();return b}])}).directive("ngTransclude",function(){return{restrict:"EAC",link:function(f,e,a,d,c){if(!c){throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag(e))}var b=a.ngTransclude||"sibling";switch(b){case"sibling":c(function(h){e.empty();e.append(h)});break;case"parent":c(f,function(h){e.empty();e.append(h)});break;case"child":var g=f.$new();c(g,function(h){e.empty();e.append(h);e.on("$destroy",function(){g.$destroy()})});break}}}});angular.module("custom",["services","filters","directives","angularFileUpload"]);angular.module("custom").config(["$httpProvider",function(a){a.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";a.defaults.transformRequest=[function(b){var c=function(g){var l="";var d,m,h,e,j,k,f;for(d in g){m=g[d];if(m instanceof Array){for(f=0;f<m.length;++f){j=m[f];h=d+"["+f+"]";k={};k[h]=j;l+=c(k)+"&"}}else{if(m instanceof Object){for(e in m){j=m[e];h=d+"["+e+"]";k={};k[h]=j;l+=c(k)+"&"}}else{if(m!==undefined&&m!==null){l+=encodeURIComponent(d)+"="+encodeURIComponent(m)+"&"}}}}return l.length?l.substr(0,l.length-1):l};return angular.isObject(b)&&String(b)!=="[object File]"?c(b):b}]}]);